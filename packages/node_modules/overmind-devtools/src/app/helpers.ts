import { Effects } from './'

export function getAppsFromStorage({ storage }: Effects) {
  return storage.get('apps')
}

export function confirm(text) {
  return function confirm({ utils }: Effects) {
    return utils.confirmDialog(text)
  }
}

export function getCurrentPortFromStorage({ storage }: Effects) {
  return storage.get('currentPort')
}

export function getNewPortFromState({ state }: Effects) {
  return state.newPortValue
}

export function storeApps({ storage, state }: Effects) {
  storage.set('apps', state.apps)
}

export function toNumber(_, value: string) {
  return String(Number(value))
}

export function connectCurrentPort(action: (message: any) => void) {
  return function connectCurrentPort({ state, connector }: Effects) {
    if (!state.currentPort) {
      return
    }

    connector.addPort(state.currentPort, action)
  }
}

export function removeCurrentPort({ state, connector }: Effects) {
  connector.removePort(state.currentPort)
}
