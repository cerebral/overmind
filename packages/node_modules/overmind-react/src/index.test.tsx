import { Overmind, TAction } from 'overmind'
import * as React from 'react'
import * as renderer from 'react-test-renderer'
/*
import { TConnect, createConnect } from './'

describe('React', () => {
  test('should connect state and actions to stateless components', () => {
    expect.assertions(2)
    let didCallAction = false
    const doThis: Action = () => (didCallAction = true)

    const config = {
      state: {
        foo: 'bar',
      },
      actions: {
        doThis,
      },
    }

    type IConfig = {
      state: {
        foo: typeof config.state.foo
      }
      actions: {
        doThis: typeof doThis
      }
    }

    const app = new Overmind(config)

    type Action<Input = void> = TAction<IConfig, Input>

    const connect = createConnect(app)

    const Component: React.SFC<TConnect<IConfig>> = ({ overmind }) => {
      overmind.actions.doThis()
      return <h1>{overmind.state.foo}</h1>
    }
    const ConnectedComponent = connect(Component)
    const tree = renderer.create(<ConnectedComponent />).toJSON()

    expect(didCallAction).toBe(true)
    expect(tree).toMatchSnapshot()
  })

  test('should connect actions and state to class components', () => {
    expect.assertions(2)
    let didCallAction = false
    const doThis: Action = () => (didCallAction = true)
    const config = {
      state: {
        foo: 'bar',
      },
      actions: {
        doThis,
      },
    }

    type IConfig = {
      state: {
        foo: typeof config.state.foo
      }
      actions: {
        doThis: typeof doThis
      }
    }

    const app = new Overmind(config)

    type Action<Input = void> = TAction<IConfig, Input>

    const connect = createConnect(app)

    class Component extends React.Component<TConnect<IConfig>> {
      componentDidMount() {
        this.props.overmind.actions.doThis()
      }
      render() {
        const { overmind } = this.props

        return <h1>{overmind.state.foo}</h1>
      }
    }
    const ConnectedComponent = connect(Component)
    const tree = renderer.create(<ConnectedComponent />).toJSON()

    expect(didCallAction).toBe(true)
    expect(tree).toMatchSnapshot()
  })

  test('should allow using component as normal, event when connected', () => {
    expect.assertions(2)
    const config = {
      state: {
        foo: 'bar',
      },
    }

    const app = new Overmind(config)

    const connect = createConnect(app)

    class Component extends React.Component<TConnect<typeof config>> {
      render() {
        const { overmind } = this.props

        return <h1>{overmind ? overmind.state.foo : 'nada'}</h1>
      }
    }
    const ConnectedComponent = connect(Component)
    const tree = renderer.create(<ConnectedComponent />).toJSON()
    const tree2 = renderer.create(<Component overmind={null as any} />).toJSON()

    expect(tree).toMatchSnapshot()
    expect(tree2).toMatchSnapshot()
  })

  test('should preserve component name', () => {
    const app = new Overmind({})
    const connect = createConnect(app)

    class FooComponent extends React.Component<TConnect<{}>> {
      render() {
        return <h1>hop</h1>
      }
    }
    function BarComponent() {
      return <div />
    }

    const ConnectedFoo = connect(FooComponent)
    const ConnectedBar = connect(BarComponent)
    expect(ConnectedFoo.name).toBe('FooComponent')
    expect(ConnectedBar.name).toBe('BarComponent')
  })
})
*/
